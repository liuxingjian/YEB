{"remainingRequest":"D:\\workplace\\myProject\\yeb\\yeb1\\yeb\\yeb-font\\node_modules\\babel-loader\\lib\\index.js!D:\\workplace\\myProject\\yeb\\yeb1\\yeb\\yeb-font\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!D:\\workplace\\myProject\\yeb\\yeb1\\yeb\\yeb-font\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\workplace\\myProject\\yeb\\yeb1\\yeb\\yeb-font\\src\\components\\sys\\basic\\PermissMana.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\workplace\\myProject\\yeb\\yeb1\\yeb\\yeb-font\\src\\components\\sys\\basic\\PermissMana.vue","mtime":1666527853824},{"path":"D:\\workplace\\myProject\\yeb\\yeb1\\yeb\\yeb-font\\babel.config.js","mtime":1666527853821},{"path":"D:\\workplace\\myProject\\yeb\\yeb1\\yeb\\yeb-font\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1666529050686},{"path":"D:\\workplace\\myProject\\yeb\\yeb1\\yeb\\yeb-font\\node_modules\\babel-loader\\lib\\index.js","mtime":1666529051466},{"path":"D:\\workplace\\myProject\\yeb\\yeb1\\yeb\\yeb-font\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1666529050686},{"path":"D:\\workplace\\myProject\\yeb\\yeb1\\yeb\\yeb-font\\node_modules\\vue-loader\\lib\\index.js","mtime":1666529052140}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:ZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJQZXJtaXNzTWFuYSIsCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHJvbGU6IHsKICAgICAgICBuYW1lOiAnJywKICAgICAgICBuYW1lWmg6ICcnCiAgICAgIH0sCiAgICAgIHJvbGVzOiBbXSwKICAgICAgbWVudXM6IFtdLAogICAgICBkZWZhdWx0UHJvcHM6IHsKICAgICAgICBjaGlsZHJlbjogJ2NoaWxkcmVuJywKICAgICAgICBsYWJlbDogJ25hbWUnCiAgICAgIH0sCiAgICAgIHNlbGVjdGVkTWVudXM6IFtdLAogICAgICBhY3RpdmVOYW1lOiAtMQogICAgfTsKICB9LAogIG1vdW50ZWQoKSB7CiAgICB0aGlzLmluaXRSb2xlcygpOwogIH0sCiAgbWV0aG9kczogewogICAgZGVsZXRlUm9sZShyb2xlKSB7CiAgICAgIHRoaXMuJGNvbmZpcm0oJ+atpOaTjeS9nOWwhuawuOS5heWIoOmZpOOAkCcgKyByb2xlLm5hbWVaaCArICfjgJHop5LoibIsIOaYr+WQpue7p+e7rT8nLCAn5o+Q56S6JywgewogICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAn56Gu5a6aJywKICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAn5Y+W5raIJywKICAgICAgICB0eXBlOiAnd2FybmluZycKICAgICAgfSkudGhlbigoKSA9PiB7CiAgICAgICAgdGhpcy5kZWxldGVSZXF1ZXN0KCcvc3lzdGVtL2Jhc2ljL3Blcm1pc3MvL2RlbGV0ZS8nICsgcm9sZS5pZCkudGhlbihyZXNwID0+IHsKICAgICAgICAgIGlmIChyZXNwKSB7CiAgICAgICAgICAgIHRoaXMuaW5pdFJvbGVzKCk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pLmNhdGNoKCgpID0+IHsKICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgIHR5cGU6ICdpbmZvJywKICAgICAgICAgIG1lc3NhZ2U6ICflt7Llj5bmtojliKDpmaQnCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIGFkZFJvbGUoKSB7CiAgICAgIGlmICh0aGlzLnJvbGUubmFtZSAmJiB0aGlzLnJvbGUubmFtZVpoKSB7CiAgICAgICAgdGhpcy5wb3N0UmVxdWVzdCgnL3N5c3RlbS9iYXNpYy9wZXJtaXNzL2FkZC8nLCB0aGlzLnJvbGUpLnRoZW4ocmVzcCA9PiB7CiAgICAgICAgICBpZiAocmVzcCkgewogICAgICAgICAgICB0aGlzLmluaXRSb2xlcygpOwogICAgICAgICAgICB0aGlzLnJvbGUgPSB7fTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCLmiYDmnInlhoXlrrnkuI3og73kuLrnqbrvvIEiKTsKICAgICAgfQogICAgfSwKICAgIGNhbmNlbFVwZGF0ZSgpIHsKICAgICAgdGhpcy5hY3RpdmVOYW1lID0gLTE7CiAgICB9LAogICAgZG9VcGRhdGUocmlkLCBpbmRleCkgewogICAgICBsZXQgdHJlZSA9IHRoaXMuJHJlZnMudHJlZVtpbmRleF07CiAgICAgIGxldCBzZWxlY3RlZEtleXMgPSB0cmVlLmdldENoZWNrZWRLZXlzKHRydWUpOwogICAgICAvLyBjb25zb2xlLmxvZyhzZWxlY3RlZEtleXMpCiAgICAgIGxldCB1cmwgPSAnL3N5c3RlbS9iYXNpYy9wZXJtaXNzL3VwZGF0ZU1lbnVSb2xlLz9yaWQ9JyArIHJpZCArICcmbWlkPScgKyBzZWxlY3RlZEtleXM7CiAgICAgIC8vIHNlbGVjdGVkS2V5cy5mb3JFYWNoKGtleSA9PiB7CiAgICAgIC8vICAgICB1cmwgKz0gJyZtaWRzPScgKyBrZXkKICAgICAgLy8gfSkKICAgICAgdGhpcy5wdXRSZXF1ZXN0KHVybCkudGhlbihyZXMgPT4gewogICAgICAgIGlmIChyZXMpIHsKICAgICAgICAgIHRoaXMuaW5pdFNlbGVjdGVkTWVudXMocmlkKTsKICAgICAgICAgIHRoaXMuYWN0aXZlTmFtZSA9IC0xOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgaW5pdFNlbGVjdGVkTWVudXMocmlkKSB7CiAgICAgIHRoaXMuZ2V0UmVxdWVzdCgnL3N5c3RlbS9iYXNpYy9wZXJtaXNzL21pZC8nICsgcmlkKS50aGVuKHJlcyA9PiB7CiAgICAgICAgaWYgKHJlcykgewogICAgICAgICAgdGhpcy5zZWxlY3RlZE1lbnVzID0gcmVzOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgY2hhbmdlKHJpZCkgewogICAgICBpZiAocmlkKSB7CiAgICAgICAgdGhpcy5pbml0TWVudXMoKTsKICAgICAgICB0aGlzLmluaXRTZWxlY3RlZE1lbnVzKHJpZCk7CiAgICAgIH0KICAgIH0sCiAgICBpbml0TWVudXMoKSB7CiAgICAgIHRoaXMuZ2V0UmVxdWVzdCgnL3N5c3RlbS9iYXNpYy9wZXJtaXNzL21lbnVzJykudGhlbihyZXMgPT4gewogICAgICAgIGlmIChyZXMpIHsKICAgICAgICAgIHRoaXMubWVudXMgPSByZXM7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBpbml0Um9sZXMoKSB7CiAgICAgIHRoaXMuZ2V0UmVxdWVzdCgnL3N5c3RlbS9iYXNpYy9wZXJtaXNzL2xpc3RBbGwnKS50aGVuKHJlcyA9PiB7CiAgICAgICAgaWYgKHJlcykgewogICAgICAgICAgdGhpcy5yb2xlcyA9IHJlczsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0KfTs="},{"version":3,"mappings":"AA6CA;EACAA;EACAC;IACA;MACAC;QACAF;QACAG;MACA;MACAC;MACAC;MACAC;QACAC;QACAC;MACA;MACAC;MACAC;IACA;EACA;EACAC;IACA;EACA;EACAC;IACAC;MACA;QACAC;QACAC;QACAC;MACA;QACA;UACA;YACA;UACA;QACA;MACA;QACA;UACAA;UACAC;QACA;MACA;IACA;IACAC;MACA;QACA;UACA;YACA;YACA;UACA;QACA;MACA;QACA;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;QACA;UACA;UACA;QACA;MACA;IACA;IACAC;MACA;QACA;UACA;QACA;MACA;IACA;IACAC;MACA;QACA;QACA;MACA;IACA;IACAC;MACA;QACA;UACA;QACA;MACA;IACA;IACAC;MACA;QACA;UACA;QACA;MACA;IACA;EACA;AACA","names":["name","data","role","nameZh","roles","menus","defaultProps","children","label","selectedMenus","activeName","mounted","methods","deleteRole","confirmButtonText","cancelButtonText","type","message","addRole","cancelUpdate","doUpdate","initSelectedMenus","change","initMenus","initRoles"],"sourceRoot":"src/components/sys/basic","sources":["PermissMana.vue"],"sourcesContent":["<template>\n    <div>\n        <div class=\"permissionManaTool\">\n            <el-input size=\"small\" placeholder=\"请输入英文名\" v-model=\"role.name\" @keydown.enter.native=\"addRole\">\n                <template slot=\"prepend\">ROLE_</template>\n            </el-input>\n            <el-input size=\"small\" v-model=\"role.nameZh\" placeholder=\"请输入中文名\" @keydown.enter.native=\"addRole\"></el-input>\n            <el-button size=\"small\" type=\"primary\" icon=\"el-icon-plus\" @click=\"addRole\">添加角色</el-button>\n        </div>\n        <div class=\"permissionManaMain\">\n            <el-collapse accordion v-model=\"activeName\" @change=\"change\">\n                <el-collapse-item v-for=\"(item,index) in roles\" :key=\"index\" :title=\"item.nameZh\" :name=\"item.id\">\n                    <el-card class=\"box-card\">\n                        <div slot=\"header\" class=\"clearfix\">\n                            <span>可访问资源</span>\n                            <el-button\n                                    style=\"float: right; padding: 3px 0;color: red\"\n                                    icon=\"el-icon-delete\"\n                                    type=\"text\"\n                                    @click=\"deleteRole(item)\"\n                            ></el-button>\n                        </div>\n                        <div>\n                            <el-tree\n                                    show-checkbox\n                                    ref=\"tree\"\n                                    :data=\"menus\"\n                                    :key=\"index\"\n                                    :props=\"defaultProps\"\n                                    :default-checked-keys=\"selectedMenus\"\n                                    node-key=\"id\"\n                            ></el-tree>\n                            <div style=\"display: flex;justify-content: flex-end\">\n                                <el-button size=\"mini\" @click=\"cancelUpdate\">取消修改</el-button>\n                                <el-button size=\"mini\" type=\"primary\" @click=\"doUpdate(item.id,index)\">确认修改</el-button>\n                            </div>\n                        </div>\n                    </el-card>\n                </el-collapse-item>\n            </el-collapse>\n        </div>\n    </div>\n</template>\n\n<script>\n    export default {\n        name: \"PermissMana\",\n        data(){\n            return {\n               role: {\n                   name: '',\n                   nameZh: ''\n               },\n                roles: [],\n                menus: [],\n                defaultProps: {\n                    children: 'children',\n                    label: 'name'\n                },\n                selectedMenus: [],\n                activeName: -1\n            }\n        },\n        mounted() {\n            this.initRoles();\n        },\n        methods: {\n            deleteRole(role){\n                this.$confirm('此操作将永久删除【'+role.nameZh+'】角色, 是否继续?', '提示', {\n                    confirmButtonText: '确定',\n                    cancelButtonText: '取消',\n                    type: 'warning'\n                }).then(() => {\n                    this.deleteRequest('/system/basic/permiss//delete/'+role.id).then(resp=>{\n                        if (resp){\n                            this.initRoles();\n                        }\n                    })\n                }).catch(() => {\n                    this.$message({\n                        type: 'info',\n                        message: '已取消删除'\n                    });\n                });\n            },\n            addRole(){\n                if (this.role.name && this.role.nameZh){\n                    this.postRequest('/system/basic/permiss/add/',this.role).then(resp=>{\n                        if (resp){\n                            this.initRoles();\n                            this.role = {};\n                        }\n                    })\n                }else {\n                    this.$message.error(\"所有内容不能为空！\")\n                }\n            },\n            cancelUpdate(){\n                this.activeName = -1\n            },\n            doUpdate(rid,index){\n                let tree = this.$refs.tree[index]\n                let selectedKeys = tree.getCheckedKeys(true)\n                // console.log(selectedKeys)\n                let url = '/system/basic/permiss/updateMenuRole/?rid=' + rid + '&mid=' + selectedKeys\n                // selectedKeys.forEach(key => {\n                //     url += '&mids=' + key\n                // })\n                this.putRequest(url).then(res => {\n                    if (res){\n                        this.initSelectedMenus(rid);\n                        this.activeName = -1;\n                    }\n                })\n            },\n            initSelectedMenus(rid){\n                this.getRequest('/system/basic/permiss/mid/'+rid).then(res =>{\n                    if (res){\n                        this.selectedMenus = res\n                    }\n                })\n            },\n            change(rid){\n                if (rid){\n                    this.initMenus();\n                    this.initSelectedMenus(rid);\n                }\n            },\n            initMenus(){\n                this.getRequest('/system/basic/permiss/menus').then(res =>{\n                    if (res){\n                        this.menus = res\n                    }\n                })\n            },\n            initRoles(){\n                this.getRequest('/system/basic/permiss/listAll').then(res =>{\n                    if (res){\n                        this.roles = res\n                    }\n                })\n            }\n        }\n    }\n</script>\n\n<style scoped>\n    .permissionManaTool{\n        display: flex;\n        justify-content: flex-start;\n    }\n    .permissionManaTool .el-input{\n        width: 300px;\n        margin-right: 6px;\n    }\n    .permissionManaMain{\n        width: 700px;\n        margin-top: 10px;\n    }\n</style>\n"]}]}