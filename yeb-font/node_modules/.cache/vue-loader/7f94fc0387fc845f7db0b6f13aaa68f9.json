{"remainingRequest":"D:\\workplace\\myProject\\yeb\\yeb1\\yeb\\yeb-font\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\workplace\\myProject\\yeb\\yeb1\\yeb\\yeb-font\\src\\views\\home\\AdminInfo.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\workplace\\myProject\\yeb\\yeb1\\yeb\\yeb-font\\src\\views\\home\\AdminInfo.vue","mtime":1666527853824},{"path":"D:\\workplace\\myProject\\yeb\\yeb1\\yeb\\yeb-font\\node_modules\\babel-loader\\lib\\index.js","mtime":1666529051466},{"path":"D:\\workplace\\myProject\\yeb\\yeb1\\yeb\\yeb-font\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1666529050686},{"path":"D:\\workplace\\myProject\\yeb\\yeb1\\yeb\\yeb-font\\node_modules\\vue-loader\\lib\\index.js","mtime":1666529052140}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CiAgICBleHBvcnQgZGVmYXVsdCB7CiAgICAgICAgbmFtZTogIkFkbWluSW5mbyIsCiAgICAgICAgZGF0YSgpewogICAgICAgICAgICB2YXIgdmFsaWRhdGVQYXNzID0gKHJ1bGUsIHZhbHVlLCBjYWxsYmFjaykgPT4gewogICAgICAgICAgICAgICAgaWYgKHZhbHVlID09PSAnJykgewogICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKG5ldyBFcnJvcign6K+36L6T5YWl5a+G56CBJykpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5ydWxlRm9ybS5jaGVja1Bhc3MgIT09ICcnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJHJlZnMucnVsZUZvcm0udmFsaWRhdGVGaWVsZCgnY2hlY2tQYXNzJyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07CiAgICAgICAgICAgIHZhciB2YWxpZGF0ZVBhc3MyID0gKHJ1bGUsIHZhbHVlLCBjYWxsYmFjaykgPT4gewogICAgICAgICAgICAgICAgaWYgKHZhbHVlID09PSAnJykgewogICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKG5ldyBFcnJvcign6K+35YaN5qyh6L6T5YWl5a+G56CBJykpOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSAhPT0gdGhpcy5ydWxlRm9ybS5wYXNzKSB7CiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sobmV3IEVycm9yKCfkuKTmrKHovpPlhaXlr4bnoIHkuI3kuIDoh7QhJykpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBjYWxsYmFjaygpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgYWRtaW46IG51bGwsCiAgICAgICAgICAgICAgICBhZG1pbjI6IG51bGwsCiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbiA6IHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCd0b2tlblN0cicpCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgZGlhbG9nVmlzaWJsZTogZmFsc2UsCiAgICAgICAgICAgICAgICBkaWFsb2dWaXNpYmxlMjogZmFsc2UsCiAgICAgICAgICAgICAgICBydWxlRm9ybTogewogICAgICAgICAgICAgICAgICAgIHBhc3M6ICcnLAogICAgICAgICAgICAgICAgICAgIGNoZWNrUGFzczogJycsCiAgICAgICAgICAgICAgICAgICAgb2xkUGFzczogJycKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBydWxlczogewogICAgICAgICAgICAgICAgICAgIHBhc3M6IFsKICAgICAgICAgICAgICAgICAgICAgICAgeyB2YWxpZGF0b3I6IHZhbGlkYXRlUGFzcywgdHJpZ2dlcjogJ2JsdXInIH0KICAgICAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgICAgIGNoZWNrUGFzczogWwogICAgICAgICAgICAgICAgICAgICAgICB7IHZhbGlkYXRvcjogdmFsaWRhdGVQYXNzMiwgdHJpZ2dlcjogJ2JsdXInIH0KICAgICAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgICAgIG9sZFBhc3M6IFsKICAgICAgICAgICAgICAgICAgICAgICAgeyB2YWxpZGF0b3I6IHZhbGlkYXRlUGFzcywgdHJpZ2dlcjogJ2JsdXInIH0KICAgICAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIG1vdW50ZWQoKSB7CiAgICAgICAgICAgIHRoaXMuaW5pdEFkbWluKCkKICAgICAgICB9LAogICAgICAgIG1ldGhvZHM6IHsKICAgICAgICAgICAgb25TdWNjZXNzKCl7CiAgICAgICAgICAgICAgICB0aGlzLmluaXRBZG1pbigpCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHN1Ym1pdEZvcm0oZm9ybU5hbWUpIHsKICAgICAgICAgICAgICAgIHRoaXMuJHJlZnNbZm9ybU5hbWVdLnZhbGlkYXRlKCh2YWxpZCkgPT4gewogICAgICAgICAgICAgICAgICAgIGlmICh2YWxpZCkgewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJ1bGVGb3JtLmFkbWluSWQgPSB0aGlzLmFkbWluLmlkCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucG9zdFJlcXVlc3QoJy9zeXN0ZW0vYWRtaW4vcGFzcycsdGhpcy5ydWxlRm9ybSkKICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXMpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOS/ruaUueWujOWvhueggSAg6YCA5Ye655m75b2VCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wb3N0UmVxdWVzdCgnL2xvZ291dCcpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LnNlc3Npb25TdG9yYWdlLnJlbW92ZUl0ZW0oJ3VzZXInKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5yZW1vdmVJdGVtKCd0b2tlblN0cicpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdpbml0Um91dGVzJyxbXSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRyb3V0ZXIucmVwbGFjZSgnLycpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2Vycm9yIHN1Ym1pdCEhJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgcmVzZXRGb3JtKGZvcm1OYW1lKSB7CiAgICAgICAgICAgICAgICB0aGlzLiRyZWZzW2Zvcm1OYW1lXS5yZXNldEZpZWxkcygpOwogICAgICAgICAgICB9LAogICAgICAgICAgICBzaG93VXBkYXRlQWRtaW5QYXNzV29yZCgpewogICAgICAgICAgICAgICAgdGhpcy5kaWFsb2dWaXNpYmxlMiA9IHRydWUKICAgICAgICAgICAgfSwKICAgICAgICAgICAgdXBkYXRlQWRtaW5JbmZvKCl7CiAgICAgICAgICAgICAgICB0aGlzLnBvc3RSZXF1ZXN0KCcvc3lzdGVtL2FkbWluL2luZm8nLHRoaXMuYWRtaW4yKS50aGVuKHJlcyA9PiB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcyl7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlhbG9nVmlzaWJsZSA9ZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbml0QWRtaW4oKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHNob3dVcGRhdGVBZG1pbkluZm8oKXsKICAgICAgICAgICAgICAgIHRoaXMuZGlhbG9nVmlzaWJsZSA9IHRydWUKICAgICAgICAgICAgfSwKICAgICAgICAgICAgaW5pdEFkbWluKCl7CiAgICAgICAgICAgICAgICB0aGlzLmdldFJlcXVlc3QoJy9hZG1pbi9pbmZvJykudGhlbihyZXMgPT57CiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcyl7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWRtaW4gPSByZXMKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hZG1pbjIgPSBPYmplY3QuYXNzaWduKHt9LHRoaXMuYWRtaW4pCiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5zZXRJdGVtKCd1c2VyJyxKU09OLnN0cmluZ2lmeShyZXMpKQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ1VOSU9OX0FETUlOJyxyZXMpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0K"},{"version":3,"sources":["AdminInfo.vue"],"names":[],"mappings":";AAkFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"AdminInfo.vue","sourceRoot":"src/views/home","sourcesContent":["<template>\n    <div>\n        <el-card class=\"box-card\" style=\"width: 400px\">\n            <div slot=\"header\" class=\"clearfix\">\n                <span>{{admin.name}}</span>\n            </div>\n            <div>\n                <div style=\"display: flex;justify-content: center\">\n                    <el-upload\n                            :headers=\"headers\"\n                            :data=\"admin\"\n                            :on-success=\"onSuccess\"\n                            :show-file-list=\"false\"\n                            action=\"system/admin/userFace\">\n                        <img style=\"width: 100px;height: 100px;border-radius: 50px\"\n                             title=\"点击修改用户头像\"\n                             :src=\"admin.userFace\"\n                             alt=\"\">\n                    </el-upload>\n                </div>\n                <div style=\"margin-top: 8px\">电话号码: <el-tag>{{admin.telephone}}</el-tag> </div>\n                <div style=\"margin-top: 8px\">手机号码: <el-tag>{{admin.phone}}</el-tag> </div>\n                <div style=\"margin-top: 8px\">居住地址: <el-tag>{{admin.address}}</el-tag> </div>\n                <div style=\"margin-top: 8px\">用户标签: <el-tag type=\"success\" v-for=\"(r,index) in admin.roles\" :key=\"index\">{{r.nameZh}}</el-tag> </div>\n                <div style=\"display: flex;justify-content: space-between;margin-top: 10px\">\n                    <el-button size=\"mini\" type=\"primary\" @click=\"showUpdateAdminInfo\">修改信息</el-button>\n                    <el-button size=\"mini\" type=\"danger\" @click=\"showUpdateAdminPassWord\">修改密码</el-button>\n                </div>\n            </div>\n        </el-card>\n\n        <el-dialog\n                title=\"编辑用户信息\"\n                :visible.sync=\"dialogVisible\"\n                width=\"30%\">\n            <div>\n                <el-form ref=\"form\" :model=\"admin2\" label-width=\"100px\">\n                    <el-form-item label=\"用户昵称\">\n                        <el-input v-model=\"admin2.name\"></el-input>\n                    </el-form-item>\n                    <el-form-item label=\"电话号码\">\n                        <el-input v-model=\"admin2.telephone\"></el-input>\n                    </el-form-item>\n                    <el-form-item label=\"手机号码\">\n                        <el-input v-model=\"admin2.phone\"></el-input>\n                    </el-form-item>\n                    <el-form-item label=\"居住地址\">\n                        <el-input v-model=\"admin2.address\"></el-input>\n                    </el-form-item>\n                </el-form>\n            </div>\n            <span slot=\"footer\" class=\"dialog-footer\">\n                <el-button @click=\"dialogVisible = false\">取 消</el-button>\n                <el-button type=\"primary\" @click=\"updateAdminInfo\">确 定</el-button>\n            </span>\n        </el-dialog>\n        <el-dialog\n                title=\"修改密码\"\n                :visible.sync=\"dialogVisible2\"\n                width=\"30%\">\n            <div>\n                <el-form :model=\"ruleForm\" status-icon :rules=\"rules\" ref=\"ruleForm\" label-width=\"100px\" class=\"demo-ruleForm\">\n                    <el-form-item label=\"请输入旧密码\" prop=\"oldPass\">\n                        <el-input type=\"password\" v-model=\"ruleForm.oldPass\" autocomplete=\"off\"></el-input>\n                    </el-form-item>\n                    <el-form-item label=\"请输入新密码\" prop=\"pass\">\n                        <el-input type=\"password\" v-model=\"ruleForm.pass\" autocomplete=\"off\"></el-input>\n                    </el-form-item>\n                    <el-form-item label=\"请确认新密码\" prop=\"checkPass\">\n                        <el-input type=\"password\" v-model=\"ruleForm.checkPass\" autocomplete=\"off\"></el-input>\n                    </el-form-item>\n                    <el-form-item>\n                        <el-button type=\"primary\" @click=\"submitForm('ruleForm')\">提交</el-button>\n                        <el-button @click=\"resetForm('ruleForm')\">重置</el-button>\n                    </el-form-item>\n                </el-form>\n            </div>\n        </el-dialog>\n    </div>\n</template>\n\n<script>\n    export default {\n        name: \"AdminInfo\",\n        data(){\n            var validatePass = (rule, value, callback) => {\n                if (value === '') {\n                    callback(new Error('请输入密码'));\n                } else {\n                    if (this.ruleForm.checkPass !== '') {\n                        this.$refs.ruleForm.validateField('checkPass');\n                    }\n                    callback();\n                }\n            };\n            var validatePass2 = (rule, value, callback) => {\n                if (value === '') {\n                    callback(new Error('请再次输入密码'));\n                } else if (value !== this.ruleForm.pass) {\n                    callback(new Error('两次输入密码不一致!'));\n                } else {\n                    callback();\n                }\n            };\n            return {\n                admin: null,\n                admin2: null,\n                headers: {\n                    Authorization : window.sessionStorage.getItem('tokenStr')\n                },\n                dialogVisible: false,\n                dialogVisible2: false,\n                ruleForm: {\n                    pass: '',\n                    checkPass: '',\n                    oldPass: ''\n                },\n                rules: {\n                    pass: [\n                        { validator: validatePass, trigger: 'blur' }\n                    ],\n                    checkPass: [\n                        { validator: validatePass2, trigger: 'blur' }\n                    ],\n                    oldPass: [\n                        { validator: validatePass, trigger: 'blur' }\n                    ]\n                }\n            }\n        },\n        mounted() {\n            this.initAdmin()\n        },\n        methods: {\n            onSuccess(){\n                this.initAdmin()\n            },\n            submitForm(formName) {\n                this.$refs[formName].validate((valid) => {\n                    if (valid) {\n                        this.ruleForm.adminId = this.admin.id\n                        this.postRequest('/system/admin/pass',this.ruleForm)\n                        .then(res => {\n                            if (res){\n                                // 修改完密码  退出登录\n                                this.postRequest('/logout')\n                                window.sessionStorage.removeItem('user')\n                                window.sessionStorage.removeItem('tokenStr')\n                                this.$store.commit('initRoutes',[])\n                                this.$router.replace('/')\n                            }\n                        })\n                    } else {\n                        console.log('error submit!!');\n                        return false;\n                    }\n                });\n            },\n            resetForm(formName) {\n                this.$refs[formName].resetFields();\n            },\n            showUpdateAdminPassWord(){\n                this.dialogVisible2 = true\n            },\n            updateAdminInfo(){\n                this.postRequest('/system/admin/info',this.admin2).then(res => {\n                    if (res){\n                        this.dialogVisible =false\n                        this.initAdmin()\n                    }\n                })\n            },\n            showUpdateAdminInfo(){\n                this.dialogVisible = true\n            },\n            initAdmin(){\n                this.getRequest('/admin/info').then(res =>{\n                    if (res){\n                        this.admin = res\n                        this.admin2 = Object.assign({},this.admin)\n                        window.sessionStorage.setItem('user',JSON.stringify(res))\n                        this.$store.commit('UNION_ADMIN',res)\n                    }\n                })\n            }\n        }\n    }\n</script>\n\n<style scoped>\n\n</style>"]}]}