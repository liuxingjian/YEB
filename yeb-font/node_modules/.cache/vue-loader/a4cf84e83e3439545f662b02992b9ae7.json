{"remainingRequest":"D:\\workplace\\myProject\\yeb\\yeb1\\yeb\\yeb-font\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\workplace\\myProject\\yeb\\yeb1\\yeb\\yeb-font\\src\\components\\sys\\basic\\PermissMana.vue?vue&type=style&index=0&id=5bfe67dd&scoped=true&lang=css&","dependencies":[{"path":"D:\\workplace\\myProject\\yeb\\yeb1\\yeb\\yeb-font\\src\\components\\sys\\basic\\PermissMana.vue","mtime":1666527853824},{"path":"D:\\workplace\\myProject\\yeb\\yeb1\\yeb\\yeb-font\\node_modules\\css-loader\\dist\\cjs.js","mtime":1666529051082},{"path":"D:\\workplace\\myProject\\yeb\\yeb1\\yeb\\yeb-font\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1666529052410},{"path":"D:\\workplace\\myProject\\yeb\\yeb1\\yeb\\yeb-font\\node_modules\\postcss-loader\\src\\index.js","mtime":1666529051463},{"path":"D:\\workplace\\myProject\\yeb\\yeb1\\yeb\\yeb-font\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1666529050686},{"path":"D:\\workplace\\myProject\\yeb\\yeb1\\yeb\\yeb-font\\node_modules\\vue-loader\\lib\\index.js","mtime":1666529052140}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5wZXJtaXNzaW9uTWFuYVRvb2x7CiAgICBkaXNwbGF5OiBmbGV4OwogICAganVzdGlmeS1jb250ZW50OiBmbGV4LXN0YXJ0Owp9Ci5wZXJtaXNzaW9uTWFuYVRvb2wgLmVsLWlucHV0ewogICAgd2lkdGg6IDMwMHB4OwogICAgbWFyZ2luLXJpZ2h0OiA2cHg7Cn0KLnBlcm1pc3Npb25NYW5hTWFpbnsKICAgIHdpZHRoOiA3MDBweDsKICAgIG1hcmdpbi10b3A6IDEwcHg7Cn0K"},{"version":3,"sources":["PermissMana.vue"],"names":[],"mappings":";AAiKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"PermissMana.vue","sourceRoot":"src/components/sys/basic","sourcesContent":["<template>\n    <div>\n        <div class=\"permissionManaTool\">\n            <el-input size=\"small\" placeholder=\"请输入英文名\" v-model=\"role.name\" @keydown.enter.native=\"addRole\">\n                <template slot=\"prepend\">ROLE_</template>\n            </el-input>\n            <el-input size=\"small\" v-model=\"role.nameZh\" placeholder=\"请输入中文名\" @keydown.enter.native=\"addRole\"></el-input>\n            <el-button size=\"small\" type=\"primary\" icon=\"el-icon-plus\" @click=\"addRole\">添加角色</el-button>\n        </div>\n        <div class=\"permissionManaMain\">\n            <el-collapse accordion v-model=\"activeName\" @change=\"change\">\n                <el-collapse-item v-for=\"(item,index) in roles\" :key=\"index\" :title=\"item.nameZh\" :name=\"item.id\">\n                    <el-card class=\"box-card\">\n                        <div slot=\"header\" class=\"clearfix\">\n                            <span>可访问资源</span>\n                            <el-button\n                                    style=\"float: right; padding: 3px 0;color: red\"\n                                    icon=\"el-icon-delete\"\n                                    type=\"text\"\n                                    @click=\"deleteRole(item)\"\n                            ></el-button>\n                        </div>\n                        <div>\n                            <el-tree\n                                    show-checkbox\n                                    ref=\"tree\"\n                                    :data=\"menus\"\n                                    :key=\"index\"\n                                    :props=\"defaultProps\"\n                                    :default-checked-keys=\"selectedMenus\"\n                                    node-key=\"id\"\n                            ></el-tree>\n                            <div style=\"display: flex;justify-content: flex-end\">\n                                <el-button size=\"mini\" @click=\"cancelUpdate\">取消修改</el-button>\n                                <el-button size=\"mini\" type=\"primary\" @click=\"doUpdate(item.id,index)\">确认修改</el-button>\n                            </div>\n                        </div>\n                    </el-card>\n                </el-collapse-item>\n            </el-collapse>\n        </div>\n    </div>\n</template>\n\n<script>\n    export default {\n        name: \"PermissMana\",\n        data(){\n            return {\n               role: {\n                   name: '',\n                   nameZh: ''\n               },\n                roles: [],\n                menus: [],\n                defaultProps: {\n                    children: 'children',\n                    label: 'name'\n                },\n                selectedMenus: [],\n                activeName: -1\n            }\n        },\n        mounted() {\n            this.initRoles();\n        },\n        methods: {\n            deleteRole(role){\n                this.$confirm('此操作将永久删除【'+role.nameZh+'】角色, 是否继续?', '提示', {\n                    confirmButtonText: '确定',\n                    cancelButtonText: '取消',\n                    type: 'warning'\n                }).then(() => {\n                    this.deleteRequest('/system/basic/permiss//delete/'+role.id).then(resp=>{\n                        if (resp){\n                            this.initRoles();\n                        }\n                    })\n                }).catch(() => {\n                    this.$message({\n                        type: 'info',\n                        message: '已取消删除'\n                    });\n                });\n            },\n            addRole(){\n                if (this.role.name && this.role.nameZh){\n                    this.postRequest('/system/basic/permiss/add/',this.role).then(resp=>{\n                        if (resp){\n                            this.initRoles();\n                            this.role = {};\n                        }\n                    })\n                }else {\n                    this.$message.error(\"所有内容不能为空！\")\n                }\n            },\n            cancelUpdate(){\n                this.activeName = -1\n            },\n            doUpdate(rid,index){\n                let tree = this.$refs.tree[index]\n                let selectedKeys = tree.getCheckedKeys(true)\n                // console.log(selectedKeys)\n                let url = '/system/basic/permiss/updateMenuRole/?rid=' + rid + '&mid=' + selectedKeys\n                // selectedKeys.forEach(key => {\n                //     url += '&mids=' + key\n                // })\n                this.putRequest(url).then(res => {\n                    if (res){\n                        this.initSelectedMenus(rid);\n                        this.activeName = -1;\n                    }\n                })\n            },\n            initSelectedMenus(rid){\n                this.getRequest('/system/basic/permiss/mid/'+rid).then(res =>{\n                    if (res){\n                        this.selectedMenus = res\n                    }\n                })\n            },\n            change(rid){\n                if (rid){\n                    this.initMenus();\n                    this.initSelectedMenus(rid);\n                }\n            },\n            initMenus(){\n                this.getRequest('/system/basic/permiss/menus').then(res =>{\n                    if (res){\n                        this.menus = res\n                    }\n                })\n            },\n            initRoles(){\n                this.getRequest('/system/basic/permiss/listAll').then(res =>{\n                    if (res){\n                        this.roles = res\n                    }\n                })\n            }\n        }\n    }\n</script>\n\n<style scoped>\n    .permissionManaTool{\n        display: flex;\n        justify-content: flex-start;\n    }\n    .permissionManaTool .el-input{\n        width: 300px;\n        margin-right: 6px;\n    }\n    .permissionManaMain{\n        width: 700px;\n        margin-top: 10px;\n    }\n</style>\n"]}]}